<!doctype html><html lang=en-us dir=ltr><head><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Writeup for VNE from PicoCTF 2023"><title>VNE Writeup</title><link rel=canonical href=https://shuban-789.github.io/p/picoctf-vne/><link rel=stylesheet href=/scss/style.min.81cbb43c4a9fdad3a645b61e185192898bfc38a9a8086aa4eaa0a18c8419d6d5.css><meta property='og:title' content="VNE Writeup"><meta property='og:description' content="Writeup for VNE from PicoCTF 2023"><meta property='og:url' content='https://shuban-789.github.io/p/picoctf-vne/'><meta property='og:site_name' content='Shuban Pal'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2023-04-06T00:00:00+00:00'><meta property='article:modified_time' content='2023-04-06T00:00:00+00:00'><meta property='og:image' content='https://shuban-789.github.io/p/picoctf-vne/cover.jpg'><meta name=twitter:title content="VNE Writeup"><meta name=twitter:description content="Writeup for VNE from PicoCTF 2023"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://shuban-789.github.io/p/picoctf-vne/cover.jpg'><link rel="shortcut icon" href=/favicon.png></head><script>window.addEventListener("load",()=>{document.body.style.zoom="reset"})</script><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_a2e99e751834560e.png width=300 height=280 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Shuban Pal</a></h1><h2 class=site-description>Operating Systems · Multiphysics simulations · CLI app dev | Go, Python, Rust</h2></div></header><ol class=menu-social><li><a href=https://github.com/shuban-789 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><img src=/icons/preferences-desktop-gaming.png alt="preferences-desktop-gaming icon" class=menu-icon>
<span>Home</span></a></li><li><a href=/archives/><img src=/icons/system-file-manager.png alt="system-file-manager icon" class=menu-icon>
<span>Archives</span></a></li><li><a href=/search/><img src=/icons/internet-web-browser.png alt="internet-web-browser icon" class=menu-icon>
<span>Search</span></a></li><li><a href=/writeups/><img src=/icons/utilities-terminal.png alt="utilities-terminal icon" class=menu-icon>
<span>Writeups</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#initial-stuff>Initial Stuff</a><ol><li><a href=#important-details>Important Details</a></li></ol></li><li><a href=#plan>Plan</a><ol><li><a href=#the-plan-in-practice>The Plan in Practice</a></li></ol></li><li><a href=#actually-doing-stuff>Actually Doing Stuff</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/picoctf-vne/><img src=/p/picoctf-vne/cover_hu_cc3a7df13f4784f6.jpg srcset="/p/picoctf-vne/cover_hu_cc3a7df13f4784f6.jpg 800w, /p/picoctf-vne/cover_hu_7403ed1986ef26c8.jpg 1600w" width=800 height=450 loading=lazy alt="Featured image of post VNE Writeup"></a></div><div class=article-details><header class=article-category><a href=/categories/pwn/ style=background-color:#e74856;color:#000>Pwn</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/picoctf-vne/>VNE Writeup</a></h2><h3 class=article-subtitle>Writeup for VNE from PicoCTF 2023</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 06, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>2 minute read</time></div></footer></div></header><section class=article-content><h2 id=initial-stuff>Initial Stuff</h2><p>It is important to get familiar with the machine we log into so that we can find important assets such as possible vulnerabilities, which we may be able to exploit to get us root access.</p><h3 id=important-details>Important Details</h3><ul><li>A binary that lists a directory as root</li><li>Why this is important: It does it as root via an SUID bit, because the root user made the executable</li><li>How it works: It takes the input for the directory as an environment variable</li><li>Other important takeaways: If it is listing the contents of a directory, it is most probably doing something with the ls binary</li></ul><p><img src=https://github.com/shuban-789/PicoPwnbooks-BinaryExploitation/assets/67974101/5815e2a0-7aa3-4358-8976-26e145f19b36 loading=lazy alt=image></p><blockquote><p>SUID, short for Set User ID, is a special permission that can be assigned to executable files. When an executable file has the SUID permission enabled, it allows users who execute the file to temporarily assume the privileges of the file&rsquo;s owner.</p></blockquote><h2 id=plan>Plan</h2><p>Using the information we have gathered, we can try to assess vulnerabilities on the target system. So far, we have thought of environment variable injection so we can try to plan this out.</p><p>We make an ls binary that spawns a shell. Since the file has an SUID, this will give us a root shell if the binary we are manipulating uses ls (in which according to the hints, it does).</p><h3 id=the-plan-in-practice>The Plan in Practice</h3><p>When &ldquo;ls&rdquo; is typed into the command line, the system looks through path for an executable with the name &ldquo;ls&rdquo;. So in the injected PATH, because <code>/tmp</code> is first, when the binary which runs ls as root runs &ldquo;ls&rdquo; as root it wil run the binary as root which will run /bin/bash root.</p><p><img src=https://github.com/shuban-789/PicoPwnbooks-BinaryExploitation/assets/67974101/9525b700-e39d-4ec6-a2b6-62fe0edec152 loading=lazy alt=image></p><h2 id=actually-doing-stuff>Actually Doing Stuff</h2><p>First, let&rsquo;s log onto the machine. To logon, we will need to use ssh with the command format of:</p><p><code>ssh -p &lt;port> &lt;user>@&lt;ip></code></p><p>After logging on, let’s list the environment variables, and try editing the PATH.</p><p><img src=https://github.com/shuban-789/PicoPwnbooks-BinaryExploitation/assets/67974101/64a60cc6-9cad-4ccb-bd9d-c21473fb51ae loading=lazy alt=image></p><p>It looks like the injection worked, so we can move on to making the fake ls executable.</p><p>Finally, we need to make the fake ls binary containing this C code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nf>system</span><span class=p>(</span><span class=s>&#34;/bin/bash&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><br><p><img src=https://github.com/shuban-789/PicoPwnbooks-BinaryExploitation/assets/67974101/a7a36a0b-8473-4114-bd49-09561a07b049 loading=lazy alt=image></p><p>then just run the bin</p><p><img src=https://github.com/shuban-789/PicoPwnbooks-BinaryExploitation/assets/67974101/984f1ed0-42e2-40c0-b297-5eb833df79e3 loading=lazy alt=image></p></section><footer class=article-footer><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Apr 06, 2023 00:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/pwn-idek/><div class=article-image><img src=/p/pwn-idek/cover.4975f09777b149c6192f26c6d80b768b_hu_732542aea9fbc2c4.png width=250 height=150 loading=lazy alt="Featured image of post myspace2 idekCTF 2025" data-key=pwn-idek data-hash="md5-SXXwl3exScYZLybG2At2iw=="></div><div class=article-details><h2 class=article-title>myspace2 idekCTF 2025</h2></div></a></article><article class=has-image><a href=/p/pwn-ropemp/><div class=article-image><img src=/p/pwn-ropemp/cover.cc08faf9420c4d22a435b74c04b2aba9_hu_292178241bf18ae6.png width=250 height=150 loading=lazy alt="Featured image of post ROP Emporium Full Solutions" data-key=pwn-ropemp data-hash="md5-zAj6+UIMTSKkNbdMBLKrqQ=="></div><div class=article-details><h2 class=article-title>ROP Emporium Full Solutions</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Shuban Pal</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>